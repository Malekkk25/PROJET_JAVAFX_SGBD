<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx/8"
            xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="projetsgbd.controllers.GestionCommandesController"

            styleClass="root"

stylesheets="@style.css" >
    <top>
        <VBox spacing="0" styleClass="header-container">
            <VBox styleClass="header-box">
                
                <!-- Top Bar -->
                <HBox alignment="CENTER_LEFT" spacing="20" styleClass="top-bar">
                    <!-- Logo + Titre -->
                    <HBox spacing="15" alignment="CENTER_LEFT">
                        <StackPane styleClass="logo-container">
                            <Label text="ðŸ“¦" styleClass="logo-icon"/>
                        </StackPane>
                        <VBox spacing="2">
                            <Label text="SystÃ¨me de Gestion" styleClass="title-main"/>
                            <Label text="des Livraisons" styleClass="title-sub"/>
                        </VBox>
                    </HBox>
                    
                    <Pane HBox.hgrow="ALWAYS"/>
                    
                 
                   
                </HBox>

                <Separator styleClass="header-separator"/>

                <!-- Navigation Tabs -->
                <HBox spacing="12" alignment="CENTER_LEFT" styleClass="nav-bar">
                    <!-- Onglet Gestion Utilisateurs -->
<HBox fx:id="tabUsers" spacing="10" alignment="CENTER"
      styleClass="nav-tab"
      onMouseClicked="#versGestionUtilisateurs">
    <Label text="ðŸ‘¥" styleClass="nav-icon"/>
    <Label text="Gestion des Utilisateurs" styleClass="nav-label"/>
</HBox>

<!-- Onglet Gestion Commandes -->
<HBox fx:id="tabCommandes" spacing="10" alignment="CENTER"
      
      styleClass="nav-tab nav-tab-active"
      onMouseClicked="#versGestionCommandes">
    <Label text="ðŸ›’" styleClass="nav-icon"/>
    <Label text="Gestion des Commandes" styleClass="nav-label"/>
</HBox>

<!-- Onglet Gestion Livraisons -->
<HBox fx:id="tabLivraisons" spacing="10" alignment="CENTER"
      styleClass="nav-tab"
      onMouseClicked="#versGestionLivraisons">
    <Label text="ðŸšš" styleClass="nav-icon"/>
    <Label text="Gestion des Livraisons" styleClass="nav-label"/>
</HBox>

                </HBox>
            </VBox>
        </VBox>
    </top>

    <!-- ========== MAIN CONTENT ========== -->
    <center>
        <ScrollPane fitToWidth="true" styleClass="main-scroll">
            <VBox spacing="28" styleClass="main-content">

                <!-- ========== FORM CARD ========== -->
                <VBox spacing="22" styleClass="card">
                    
                    <!-- Card Header -->
                    <HBox spacing="12" alignment="CENTER_LEFT" styleClass="card-header">
                        <StackPane styleClass="card-icon-container">
                            <Label text="ðŸ›’" styleClass="card-icon"/>
                        </StackPane>
                        <VBox spacing="2">
                            <Label text="Ajouter une Nouvelle Commande" styleClass="card-title"/>
                            <Label text="CrÃ©ez une nouvelle commande pour un client" styleClass="card-subtitle"/>
                        </VBox>
                    </HBox>

                    <Separator styleClass="card-separator"/>

                    <!-- Form Grid -->
                    <GridPane hgap="20" vgap="18">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="33.33"/>
                            <ColumnConstraints percentWidth="33.33"/>
                            <ColumnConstraints percentWidth="33.33"/>
                        </columnConstraints>

                        <!-- Row 1 -->
                        <VBox spacing="10" GridPane.columnIndex="0" GridPane.rowIndex="0">
                            <HBox spacing="6" alignment="CENTER_LEFT">
                                <Label text="Client" styleClass="field-label"/>
                                <Label text="*" styleClass="field-required"/>
                            </HBox>
                            <ComboBox fx:id="cmbClient" 
                                      maxWidth="Infinity"
                                      promptText="SÃ©lectionner un client..."
                                      styleClass="field-input"/>
                        </VBox>

                        <VBox spacing="10" GridPane.columnIndex="1" GridPane.rowIndex="0">
                            <Label text="Date Commande" styleClass="field-label"/>
                            <DatePicker fx:id="dpDateCommande"
                                       maxWidth="Infinity"
                                       promptText="JJ/MM/AAAA"
                                       styleClass="field-input"/>
                        </VBox>

                        <!-- Articles Section -->
                        <VBox spacing="10" GridPane.columnIndex="2" GridPane.rowIndex="0">
                            <Label text="Articles de la commande" styleClass="field-label"/>
                            <ComboBox fx:id="cmbArticle" 
                                      maxWidth="Infinity"
                                      promptText="SÃ©lectionner un article..."
                                      styleClass="field-input"/>
                        </VBox>

                        <!-- Row 2: Quantity and Add Button -->
                        <VBox spacing="10" GridPane.columnIndex="0" GridPane.rowIndex="1">
                            <Label text="QtÃ©" styleClass="field-label"/>
                            <TextField fx:id="txtQuantite"
                                      promptText="0"
                                      styleClass="field-input"/>
                        </VBox>

                        <VBox spacing="10" alignment="BOTTOM_CENTER" GridPane.columnIndex="1" GridPane.rowIndex="1">
                            <Region VBox.vgrow="ALWAYS"/>
                            <Button text="+  Ajouter"
                                    fx:id="btnAjouterArticle"
                                    onAction="#handleAjouterArticle"
                                    maxWidth="Infinity"
                                    styleClass="btn-success"/>
                        </VBox>

                        <VBox spacing="10" alignment="BOTTOM_CENTER" GridPane.columnIndex="2" GridPane.rowIndex="1">
                            <Region VBox.vgrow="ALWAYS"/>
                            <Button text="âœ“  Enregistrer"
                                    fx:id="btnEnregistrer"
                                    onAction="#handleEnregistrer"
                                    maxWidth="Infinity"
                                    styleClass="btn-primary"/>
                        </VBox>
                    </GridPane>
                </VBox>

                <!-- ========== TABLE CARD ========== -->
                <VBox spacing="22" styleClass="card">
                    
                    <!-- Card Header -->
                    <HBox spacing="15" alignment="CENTER_LEFT" styleClass="card-header">
                        <StackPane styleClass="card-icon-container">
                            <Label text="ðŸ“‹" styleClass="card-icon"/>
                        </StackPane>
                        <VBox spacing="2" HBox.hgrow="ALWAYS">
                            <Label text="Liste des Commandes" styleClass="card-title"/>
                            <Label text="GÃ©rez et consultez toutes les commandes" styleClass="card-subtitle"/>
                        </VBox>
                        <HBox spacing="10" alignment="CENTER_RIGHT">
                            <Label fx:id="lblCommandesCount" text="3 commandes" styleClass="table-count"/>
                        </HBox>
                    </HBox>

                    <Separator styleClass="card-separator"/>
<HBox spacing="10" alignment="CENTER_LEFT" style="-fx-padding: 0 0 10 0;">
    <Label text="Rechercher :" styleClass="field-label"/>
    <TextField fx:id="searchField"
               promptText="NÂ° commande ou client..."
               styleClass="field-input"
               onKeyReleased="#handleSearch"/>
</HBox>
                    <!-- Table -->
                    <TableView fx:id="tableCommandes" 
                               prefHeight="380"
                               styleClass="modern-table">
                        <columns>
                            <TableColumn fx:id="colNumero" text="NÂ° Commande" prefWidth="130"/>
                            <TableColumn fx:id="colClient" text="Client" prefWidth="180"/>
                            <TableColumn fx:id="colDate" text="Date" prefWidth="120"/>
                            <TableColumn fx:id="colEtat" text="Ã‰tat" prefWidth="110"/>
                            <TableColumn fx:id="colMontant" text="Montant" prefWidth="120"/>
                            <TableColumn fx:id="colActions" text="Actions" prefWidth="300"/>
                        </columns>
                        <placeholder>
                            <VBox spacing="15" alignment="CENTER" style="-fx-padding: 40;">
                                <Label text="ðŸ“­" style="-fx-font-size: 48px; -fx-opacity: 0.3;"/>
                                <Label text="Aucune commande trouvÃ©e" styleClass="empty-message"/>
                                <Label text="Ajoutez votre premiÃ¨re commande ci-dessus" styleClass="empty-hint"/>
                            </VBox>
                        </placeholder>
                    </TableView>
                </VBox>

            </VBox>
        </ScrollPane>
    </center>

</BorderPane>